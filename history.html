<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
  <link rel="stylesheet" href="./css/common.min.css" />
  <link rel="stylesheet" href="./css/histroy.min.css">
  <script src="./js/style.js"></script>
  <script src="./header.js"></script>
  <script src="./pagination.js"></script>
  <script src="./footer.js"></script>
</head>

<body>
  <article class="history-wrap wrapper" id="history">
    <script>header();</script>
    <h1 class="title bor10 btn-off"><span class="s-tit active">검색 이력</span><span class="t-tit">추적 이력</span> </h1>
    <!-- 검색 이력 -->
    <section class="search-history layout history active">
      <div class="searchbox">
        <form name="history-search" class="search-box">
          <input type="text" class="list-search bor10 btn-off" placeholder="검색어를 입력해 주세요">
        </form>
        <p class="total-num">총 <span>30</span>건</p>
      </div>
      <h2>
        <span class="num">순번</span>
        <span class="counselor">상담사</span>
        <span class="type">검색 유형</span>
        <span class="cont">내용</span>
        <span class="social">SNS</span>
        <span class="time">검색 일시</span>
        <span class="progress">검색 진행률</span>
        <span class="dist">구분</span></h2>
      <ul class="history-list history-search-list">
      </ul>
    </section>
    <!-- 추적이력 -->
    <section class="trace-history layout history">
      <div class="searchbox">
        <form name="history-search" class="search-box">
          <input type="text" class="list-search bor10 btn-off" placeholder="검색어를 입력해 주세요">
        </form>
        <ul class="currently-state">
          <li><span>전체 :</span> 32</li>
          <li><span>모니터링 :</span> 8</li>
          <li><span>삭제 요청 :</span> 10</li>
          <li><span>삭제 완료 :</span> 14</li>
        </ul>
      </div>
      <h2><span class="num">순번</span><span class="cont">내용 및 검색 정보</span> <span class="memo">메모</span> <span
          class="state">상태</span><span class="double-chk">2차 검증</span></h2>
      <ul class="history-list history-trace-list">
        
      </ul>
    </section>

    <script>
      pagination();
      footer();
    </script>
  </article>
  <script>
    //  검색이력 리스트
    const searchList = document.querySelector(".history-search-list");
    for (let i = 15; i > 0; i--) {
      searchList.innerHTML += `
        <li class="btn-off bor10">
            <p class="num">${i * 2}</p>
            <p class="counselor">admin</p>
            <p class="type"><span></span><span>키워드</span></p>
            <p class="cont"><span class="con1">엄훠나 세솽에 이런 일이 다 있고 참 이상하네요 정말 정말 정말 왜 이렇게 이상할까요?????</span> <span class='con2'></span></p>
            <p class="social">
              <img src="./img/common/sns/face.png" alt="">
              <img src="./img/common/sns/twitter.png" alt="">
              <img src="./img/common/sns/insta.png" alt="">
            </p>
            <p class="time">2022.12.12 &nbsp; 12:44:01</p>
            <p class="dot-wrap progress">
              <span class="dot"></span>
              <span class="dot-per">78%</span>
            </p>
            <button class="btn-off review">검색결과</button>
            <button class="del-btn btn-off">삭제</button>
          </li>
          <li class="btn-off bor10">
            <p class="num">${i * 2 - 1}</p>
            <p class="counselor">admin000000000000000000</p>
            <p class="type"><span><img src="./img/common/research.png" alt="" class="reply"></span><span>키워드 + 사진</span></p>
            <p class="cont"><span class="con1">엄훠나 세솽에 이런 일이 다 있고 참 이상하네요</span> <span class='con2'>&nbsp;/ abcdefghijk.png</span></p>
            <p class="social">
              <img src="./img/common/sns/face.png" alt="">
              <img src="./img/common/sns/google.png" alt="">
              <img src="./img/common/sns/insta.png" alt="">
            </p>
            <p class="time">2022.12.12 &nbsp; 12:44:01</p>
            <p class="dot-wrap progress">
              <span class="dot"></span>
              <span class="dot-per">100%</span>
            </p>
            <button class="btn-off review">검색결과</button>
            <button class="del-btn btn-off">삭제</button>
          </li>
        `;
    }
    //추적 이력
    const traceList = document.querySelector(".history-trace-list");
    for (let i = 16; i > 0; i--) {
      // 태그수정(0319수정)
      traceList.innerHTML += `
      <li class="btn-off bor10">
          <p class="num">${2*i}</p>
          <div class="cont">
            <div class="img-box">
              <div class="img">
                <img src="./img/replace/man.png" alt="">
              </div>
              <img src="./img/common/sns/google.png" alt="" class="sns">
            </div>
            <div class="text">
              <a href="#" class="url" target="_blank">url이 들어갑니다url이 들어갑니다url이 들어갑니다url이 들어갑니다 들어갑니다  들어갑니다 들어갑니다 들어갑니다</a>
              <p class="content">내용이 들어갑니다 내용이 들어갑니다내용이 들어갑니다내용이 들어갑니다</p>
              <p class="detail"><span class="detail-info">검색정보 : 키워드 + 사진 / 키워드가 들어 갑니다 , 파일명이 들어갑니다 </span> <span class="detail-time">검색일 : 2022.01.12</span></p>
            </div>
          </div>
          <textarea placeholder="내용 입력" class="btn-on memo" ></textarea>
          <div class="state">
            <input type="hidden" class="bor10 M-box-in" name="trace-state">
            <div class="selection">
              <button>삭제 완료</button>
              <ul class="option">
                <li>삭제 완료</li>
                <li>삭제 요청</li>
                <li>모니터링</li>
              </ul>
            </div>
          </div>
          <button class="btn-off double-chk">2차 검증</button>
        </li>
        <li class="btn-off bor10">
          <p class="num">${2*i-1}</p>
          <div class="cont">
            <div class="img-box">
              <div class="img">
                <img src="./img/replace/man.png" alt="">
              </div>
              <img src="./img/common/sns/google.png" alt="" class="sns">
            </div>
            <div class="text">
              <a href="#" class="url" target="_blank">url이 들어갑니다url이 들어갑니다url이 들어갑니다url이 들어갑니다</a>
              <p class="content">내용이 들어갑니다 내용이 들어갑니다내용이 들어갑니다내용이 들어갑니다 내용이 들어갑니다 내용이 들어갑니다내용이 들어갑니다내용이 들어갑니다</p>
              <p class="detail"><span class="detail-info">검색정보 : 키워드 + 사진 / 키워드가 들어 갑니다 , 파일명이 들어갑니다 </span> <span class="detail-time">검색일 : 2022.01.12</span></p>
            </div>
          </div>
          <textarea placeholder="내용 입력" class="btn-on memo" ></textarea>
          <div class="state">
            <input type="hidden" class="bor10 M-box-in" name="trace-state">
            <div class="selection">
              <button>모니터링</button>
              <ul class="option">
                <li>삭제 완료</li>
                <li>삭제 요청</li>
                <li>모니터링</li>
              </ul>
            </div>
          </div>
          <button class="btn-off double-chk">2차 검증</button>
        </li>
        `;
    }
    // 히스토리 탭
    const hisTab = document.querySelectorAll('.title span');
    const his = document.querySelectorAll('.history');

    hisTab.forEach((tab, idx) => {
      tab.onclick = (e) => {
        getSiblings(e.target).forEach(t => {
          t.classList.remove('active');
        });
        his.forEach(gr => {
          gr.classList.remove('active');
        })
        e.target.classList.add('active');
        his[idx].classList.add('active');
      }
    })
    // 셀렉트 구현(0317 수정)
    const select = document.querySelectorAll(".selection");
    for (let i = 0; i < select.length; i++) {
      switch (select[i].children[0].innerText) {
        case '삭제 요청':
          select[i].children[0].style.color = '#e87728';
          break;
        case '모니터링':
          select[i].children[0].style.color = '#194894';
          break;
      }
      select[i].addEventListener("click", (e) => {
        select[i].classList.toggle('active');
        const option = select[i].querySelectorAll(".option li");
        option.forEach(btn => {
          btn.addEventListener('click', (e) => {
            let val = e.target.innerText;
            select[i].children[0].innerHTML = val;
            switch (e.target.innerText) {
              case '삭제 요청':
                select[i].children[0].style.color = '#e87728';
                break;
              case '모니터링':
                select[i].children[0].style.color = '#194894';
                break;
            }
          })
        });
      });
    }
    //검색이력 내용 넓이
    const context = document.querySelectorAll(".history-search-list .cont");
    context.forEach(con => {
      if (con.querySelector('.con2').innerHTML === '') {
        con.querySelector('.con2').style.display = 'none';
        con.querySelector('.con1').style.maxWidth = "100%";
      }
    })

    // 검색 진행률
    const progress = document.querySelectorAll("#history .dot-wrap");
    progress.forEach(pro => {
      const per = pro.querySelector(".dot-per");
      const loding = pro.querySelector(".dot");
      if (per.innerText === '100%') {
        loding.style.display = "none";
        per.style.fontSize = "1rem";
        per.style.cssText = "font-size:1rem; color:#545759;";
        pro.nextElementSibling.innerHTML = "다시보기";
        pro.nextElementSibling.style.color = "#e87728";
      }
    })

  </script>
</body>

</html>